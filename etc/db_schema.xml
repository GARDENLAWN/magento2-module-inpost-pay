<?xml version="1.0"?>
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd">
    <table name="inpost_pay_order" resource="default" engine="innodb">
        <column xsi:type="int" name="inpost_pay_order_id" unsigned="true" nullable="false" identity="true"/>
        <column xsi:type="int" name="order_id" unsigned="true" nullable="false" identity="false"/>
        <column xsi:type="varchar" name="basket_id" length="255" nullable="true"/>
        <column xsi:type="varchar" name="basket_binding_api_key" length="1024" nullable="false"/>
        <column xsi:type="varchar" name="payment_type" length="255" nullable="true"/>
        <column xsi:type="varchar" length="255" name="locker_id" nullable="true"/>
        <column xsi:type="varchar" name="order_status" length="255" nullable="true"/>
        <column xsi:type="varchar" name="country_prefix" length="4" nullable="true"/>
        <column xsi:type="varchar" name="phone" length="12" nullable="true"/>
        <column xsi:type="varchar" name="courier_note" length="255" nullable="true"/>
        <column xsi:type="varchar" name="ga_client_id" length="255" nullable="true" />
        <column xsi:type="varchar" name="fbclid" length="255" nullable="true" />
        <column xsi:type="varchar" name="gclid" length="255" nullable="true" />
        <column xsi:type="text" name="serialized_analytics_data" nullable="true"/>
        <column xsi:type="timestamp" name="analytics_sent_at" nullable="true"/>
        <column xsi:type="varchar" length="255" name="delivery_options" nullable="true"/>
        <column xsi:type="text" name="accepted_consents" nullable="true"/>
        <column xsi:type="varchar" length="255" name="inpost_pay_account_email" nullable="true"/>
        <column xsi:type="tinyint" name="order_with_invoice" nullable="false" default="1"/>
        <column xsi:type="varchar" length="255" name="inpost_pay_invoice_email" nullable="true"/>
        <column xsi:type="varchar" length="255" name="delivery_email" nullable="true"/>
        <column xsi:type="varchar" length="255" name="digital_delivery_email" nullable="true"/>
        <column xsi:type="tinyint" name="is_timed_out" nullable="false" default="0"/>
        <column xsi:type="tinyint" name="is_time_out_handled" nullable="false" default="0"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="inpost_pay_order_id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="INPOST_PAY_ORDER_ORDER_ID_SALES_ORDER_ENTITY_ID"
                    table="inpost_pay_order" column="order_id"
                    referenceTable="sales_order" referenceColumn="entity_id"
                    onDelete="CASCADE"/>
        <constraint xsi:type="unique" referenceId="UNIQUE_INPOST_PAY_ORDER_ORDER_ID">
            <column name="order_id"/>
        </constraint>
    </table>
    <table name="inpost_pay_quote" resource="default" engine="innodb">
        <column name="inpost_pay_quote_id" xsi:type="int" unsigned="true" nullable="false" identity="true" comment="Entity id"/>
        <column xsi:type="int" name="quote_id" unsigned="true" nullable="false" identity="false"/>
        <column xsi:type="varchar" name="basket_id" length="255" nullable="false"/>
        <column xsi:type="varchar" name="basket_binding_api_key" length="1024" nullable="false"/>
        <column xsi:type="varchar" name="inpost_basket_id" length="255" nullable="true"/>
        <column xsi:type="varchar" name="status" length="32" nullable="false" default="PENDING"/>
        <column xsi:type="varchar" name="phone" length="12" nullable="true"/>
        <column xsi:type="varchar" name="country_prefix" length="12" nullable="true"/>
        <column xsi:type="varchar" name="masked_phone_number" length="12" nullable="true"/>
        <column xsi:type="tinyint" name="browser_trusted" nullable="false" default="0"/>
        <column xsi:type="varchar" name="browser_id" length="255" nullable="true"/>
        <column xsi:type="varchar" name="name" length="255" nullable="true"/>
        <column xsi:type="varchar" name="surname" length="255" nullable="true"/>
        <column xsi:type="varchar" name="cart_version" length="255" nullable="true" />
        <column xsi:type="varchar" name="ga_client_id" length="255" nullable="true" />
        <column xsi:type="varchar" name="fbclid" length="255" nullable="true" />
        <column xsi:type="varchar" name="gclid" length="255" nullable="true" />
        <column xsi:type="varchar" name="session_cookie" length="255" nullable="true" />
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="inpost_pay_quote_id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="INPOST_PAY_QUOTE_QUOTE_ID_QUOTE_ENTITY_ID"
                    table="inpost_pay_quote" column="quote_id"
                    referenceTable="quote" referenceColumn="entity_id"
                    onDelete="CASCADE"/>
        <constraint xsi:type="unique" referenceId="INPOST_PAY_QUOTE_QUOTE_ID">
            <column name="quote_id"/>
        </constraint>
        <index referenceId="INPOST_PAY_QUOTE_INPOST_BASKET_ID" indexType="btree">
            <column name="inpost_basket_id"/>
        </index>
        <index referenceId="INPOST_PAY_QUOTE_BASKET_ID" indexType="btree">
            <column name="basket_id"/>
        </index>
    </table>
    <table name="inpost_pay_checkout_agreement_version" resource="default" engine="innodb">
        <column xsi:type="int" name="agreement_id" unsigned="true" nullable="false" identity="false"/>
        <column xsi:type="varchar" name="version" length="255" nullable="false"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="agreement_id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="CHKT_AGRT_VER_AGRT_ID_CHKT_AGRT_AGRT_ID" table="checkout_agreement_version"
                    column="agreement_id" referenceTable="checkout_agreement" referenceColumn="agreement_id"
                    onDelete="CASCADE"/>
    </table>
    <table name="inpost_pay_basket_notice" resource="default" engine="innodb">
        <column xsi:type="int" name="basket_notice_id" unsigned="true" nullable="false" identity="true"/>
        <column xsi:type="int" name="inpost_pay_quote_id" unsigned="true" nullable="false" identity="false"/>
        <column xsi:type="varchar" name="type" length="255" nullable="false"/>
        <column xsi:type="varchar" name="description" length="255" nullable="false"/>
        <column xsi:type="tinyint" name="is_sent" nullable="false" default="0"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="basket_notice_id"/>
        </constraint>
        <constraint xsi:type="foreign"
                    referenceId="INPOST_PAY_BASKET_NOTICE_BASKET_NOTICE_ID_INPOST_PAY_QUOTE_INPOST_PAY_QUOTE_ID"
                    table="inpost_pay_basket_notice" column="inpost_pay_quote_id"
                    referenceTable="inpost_pay_quote" referenceColumn="inpost_pay_quote_id"
                    onDelete="CASCADE"/>
        <constraint xsi:type="unique" referenceId="UNIQUE_INPOST_PAY_BASKET_NOTICE_BASKET_NOTICE_ID">
            <column name="basket_notice_id"/>
        </constraint>
        <index referenceId="INPOST_PAY_BASKET_NOTICE_INPOST_PAY_QUOTE_ID" indexType="btree">
            <column name="inpost_pay_quote_id"/>
        </index>
        <index referenceId="INPOST_PAY_BASKET_NOTICE_IS_SENT" indexType="btree">
            <column name="is_sent"/>
        </index>
    </table>
    <table name="inpost_pay_available_payment_method" resource="default" engine="innodb">
        <column xsi:type="int" name="payment_method_id" unsigned="true" nullable="false" identity="true"/>
        <column xsi:type="varchar" name="payment_code" length="255" nullable="false"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="unique" referenceId="UNIQUE_INPOST_PAY_AVAILABLE_PAYMENT_METHOD_PAYMENT_METHOD_ID">
            <column name="payment_method_id"/>
        </constraint>
    </table>
    <table name="inpost_pay_bestseller_product" resource="default" engine="innodb">
        <column xsi:type="int" name="bestseller_product_id" unsigned="true" nullable="false" identity="true"/>
        <column xsi:type="varchar" name="sku" length="255" nullable="false"/>
        <column xsi:type="smallint" name="website_id" nullable="false" unsigned="true" identity="false" default="0"/>
        <column xsi:type="timestamp" name="available_start_date" nullable="true"/>
        <column xsi:type="timestamp" name="available_end_date" nullable="true"/>
        <column xsi:type="timestamp" name="synchronized_at" nullable="true"/>
        <column xsi:type="text" name="qr_code" nullable="true"/>
        <column xsi:type="varchar" name="deep_link" length="512" nullable="false"/>
        <column xsi:type="varchar" name="inpost_pay_status" length="255" nullable="false"/>
        <column xsi:type="varchar" name="error" length="1024" nullable="false"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="bestseller_product_id"/>
        </constraint>
        <constraint xsi:type="unique" referenceId="UNIQUE_INPOST_PAY_BESTSELLER_PRODUCT_SKU_WEBSITE_ID">
            <column name="sku"/>
            <column name="website_id"/>
        </constraint>
    </table>
    <table name="inpost_pay_checkout_agreement" resource="default" engine="innodb" comment="InPost Pay Checkout Agreement">
        <column xsi:type="int" name="agreement_id" unsigned="true" nullable="false" identity="true" comment="ID"/>
        <column xsi:type="varchar" name="title" length="255" nullable="false"  comment="Title"/>
        <column xsi:type="boolean" name="is_enabled" nullable="false" default="0" comment="Is Enabled Flag"/>
        <column xsi:type="tinyint" name="visibility" nullable="false" default="1" comment="Visibility"/>
        <column xsi:type="varchar" name="requirement" nullable="false" length="40" default="OPTIONAL"  comment="Requirement"/>
        <column xsi:type="varchar" name="children_ids" nullable="true" comment="Children IDs"/>
        <column xsi:type="varchar" name="checkbox_text" nullable="false" comment="Checkbox Text"/>
        <column xsi:type="varchar" name="agreement_url" length="500" nullable="false" comment="Agreement URL"/>
        <column xsi:type="varchar" name="url_label" length="500" nullable="false" comment="URL Label"/>
        <column xsi:type="varchar" name="version" length="255" nullable="false" comment="Version Hash"/>
        <column name="created_at" xsi:type="timestamp" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
        <column name="updated_at" xsi:type="timestamp" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="agreement_id"/>
        </constraint>
        <constraint xsi:type="unique" referenceId="UNIQUE_IP_CHKT_AGRT_VERSION">
            <column name="version"/>
        </constraint>
    </table>
    <table name="inpost_pay_checkout_agreement_store" resource="default" engine="innodb" comment="InPost Pay Checkout Agreement Store">
        <column xsi:type="int" name="entity_id" unsigned="true" nullable="true" identity="true" comment="Entity ID"/>
        <column xsi:type="int" name="agreement_id" unsigned="true" nullable="false" identity="false" comment="Agreement ID"/>
        <column xsi:type="smallint" name="store_id" unsigned="true" nullable="false" identity="false" comment="Store ID"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="entity_id"/>
        </constraint>
        <constraint xsi:type="unique" referenceId="UNIQUE_IP_CHKT_AGRT_STORE_AGREEMENT_ID_STORE_ID">
            <column name="agreement_id"/>
            <column name="store_id"/>
        </constraint>
        <constraint xsi:type="foreign"
                    referenceId="IP_CHKT_AGRT_STORE_AGRT_ID_IP_CHKT_AGRT_AGRT_ID"
                    table="inpost_pay_checkout_agreement_store"
                    column="agreement_id"
                    referenceTable="inpost_pay_checkout_agreement"
                    referenceColumn="agreement_id"
                    onDelete="CASCADE"/>
        <constraint xsi:type="foreign"
                    referenceId="IP_CHKT_AGRT_STORE_STORE_ID_STORE_STORE_ID"
                    table="inpost_pay_checkout_agreement_store"
                    column="store_id"
                    referenceTable="store"
                    referenceColumn="store_id"
                    onDelete="CASCADE"/>
    </table>
</schema>
